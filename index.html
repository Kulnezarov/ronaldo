<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>–î–ª—è –ñ–∞–Ω—ã–º</title>
<style>
  html, body {
    margin: 0;
    padding: 0;
    background: radial-gradient(circle at center, #000000, #660000 90%);
    font-family: sans-serif;
    color: white;
    min-height: 100vh;
    overflow-x: hidden; /* –ó–∞–ø—Ä–µ—â–∞–µ–º –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—É—é –ø—Ä–æ–∫—Ä—É—Ç–∫—É */
    position: relative;
    display: flex;
    justify-content: center;
    align-items: flex-start; /* –í—ã—Ä–∞–≤–Ω–∏–≤–∞–µ–º –∫–æ–Ω—Ç–µ–Ω—Ç –ø–æ –≤–µ—Ä—Ö—É –¥–ª—è —Å–∫—Ä–æ–ª–ª–∞ */
    text-align: center;
    padding: 8vh 15px; /* –î–æ–±–∞–≤–ª—è–µ–º –æ—Ç—Å—Ç—É–ø—ã, —á—Ç–æ–±—ã –∫–æ–Ω—Ç–µ–Ω—Ç –Ω–µ –ø—Ä–∏–ª–∏–ø–∞–ª –∫ –∫—Ä–∞—è–º */
    box-sizing: border-box;
  }
  @keyframes pulse {
    0% { opacity: 0.8; }
    50% { opacity: 1; }
    100% { opacity: 0.8; }
  }
  .main-content {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center; /* –¶–µ–Ω—Ç—Ä–∏—Ä—É–µ–º –∫–æ–Ω—Ç–µ–Ω—Ç –Ω–∞ –≥–ª–∞–≤–Ω–æ–º —ç–∫—Ä–∞–Ω–µ */
    z-index: 2;
    /* –æ—Å—Ç–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É –Ω–∞ –º–µ—Å—Ç–µ: –Ω–∏—á–µ–≥–æ –Ω–µ –º–µ–Ω—è–µ–º –ø–æ –æ—Ç—Å—Ç—É–ø–∞–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ */
    width: 100%;
    max-width: 90%;
    box-sizing: border-box;
  }
  h1 {
    font-size: clamp(24px, 7vw, 42px);
    color: #ffffff;
    text-shadow: 2px 2px 8px rgba(0,0,0,0.8);
    animation: pulse 3s infinite ease-in-out;
    margin: 0 0 10px 0;
    will-change: transform;
  }
  p {
    font-size: clamp(14px, 4vw, 20px);
    color: #ffffff;
    margin-bottom: 20px;
    will-change: transform;
  }
  /* –ü–æ–¥–Ω–∏–º–∞–µ–º –¢–û–õ–¨–ö–û —Ç–µ–∫—Å—Ç –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞—Ö. –ö–Ω–æ–ø–∫—É –Ω–µ —Ç—Ä–æ–≥–∞–µ–º. */
  /* –ò–°–ü–†–ê–í–õ–ï–ù–û: –¢–µ–ø–µ—Ä—å –ø–æ–¥–Ω–∏–º–∞–µ–º –≤–µ—Å—å –±–ª–æ–∫ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–æ–ø–æ—Ä—Ü–∏–π */
  @media (max-width: 768px) {
    .main-content { transform: translateY(-5vh); }
  }
  @keyframes fall {
    to {
      transform: translateY(105vh) rotate(30deg);
      opacity: 0;
    }
  }
  /* –ö–Ω–æ–ø–∫–∞ –ø–∏—Å—å–º–∞ –æ—Å—Ç–∞—ë—Ç—Å—è —Ä–æ–≤–Ω–æ –∫–∞–∫ –±—ã–ª–∞ —É —Ç–µ–±—è */
  .center-button {
    display: inline-block;
    margin-top: 20px;
    padding: clamp(20px, 6vw, 40px) clamp(30px, 10vw, 80px);
    background: linear-gradient(to right, #ff4d4d, #ff8080);
    color: white;
    font-size: clamp(20px, 6vw, 48px);
    border: none;
    border-radius: 50px;
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: 0 4px 15px rgba(255, 77, 77, 0.6);
    text-transform: uppercase;
    letter-spacing: 2px;
    white-space: nowrap;
  }
  .center-button:hover {
    box-shadow: 0 6px 20px rgba(255, 77, 77, 0.8);
    transform: scale(1.05);
  }
  .music-button {
    position: fixed;
    bottom: 20px;
    left: 20px;
    width: 60px;
    height: 60px;
    background: rgba(255, 255, 255, 0.3);
    color: white;
    border: 2px solid white;
    border-radius: 50%;
    font-size: 24px;
    cursor: pointer;
    z-index: 10000;
    transition: background 0.3s;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  .music-button:hover {
    background: rgba(255, 255, 255, 0.5);
  }

  /* --- –°—Ç–∏–ª–∏ –¥–ª—è –Ω–æ–≤—ã—Ö —ç–∫—Ä–∞–Ω–æ–≤ --- */
  #page-container {
    width: 100%;
    height: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
    transition: opacity 0.5s ease-in-out;
  }

  .content-wrapper {
    /* –£–±—Ä–∞–ª–∏ —Ñ–æ–Ω, —á—Ç–æ–±—ã –≤—Å–µ –±—ã–ª–æ –Ω–∞ –æ–¥–Ω–æ–º –≥—Ä–∞–¥–∏–µ–Ω—Ç–µ */
    padding: 60px 20px 40px 20px; /* –î–æ–±–∞–≤–∏–ª–∏ –æ—Ç—Å—Ç—É–ø —Å–≤–µ—Ä—Ö—É –¥–ª—è –∫–Ω–æ–ø–∫–∏ "–ù–∞–∑–∞–¥" */
    border-radius: 15px;
    max-width: 100%; /* –®–∏—Ä–∏–Ω–∞ –±—É–¥–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∞ —Ä–æ–¥–∏—Ç–µ–ª–µ–º */
    width: 700px;
    text-align: center;
    position: relative; /* –î–ª—è –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∫–Ω–æ–ø–æ–∫ */
    box-sizing: border-box;
    z-index: 2; /* –ß—Ç–æ–±—ã –±—ã—Ç—å –ù–ê–î –ø–∞–¥–∞—é—â–∏–º–∏ —Å–ª–æ–≤–∞–º–∏ */
  }

  .content-wrapper h2 {
    color: #ffc0cb; /* –†–æ–∑–æ–≤—ã–π —Ü–≤–µ—Ç –¥–ª—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤, —Ö–æ—Ä–æ—à–æ –≤–∏–¥–µ–Ω –Ω–∞ —Ç–µ–º–Ω–æ–º */
    text-shadow: 2px 2px 8px rgba(0,0,0,0.8);
    margin-top: 0;
    font-size: clamp(22px, 5vw, 28px);
  }
  .content-wrapper p {
    color: #ffffff; /* –ë–µ–ª—ã–π —Ü–≤–µ—Ç –¥–ª—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ */
    text-align: left; /* –í—ã—Ä–∞–≤–Ω–∏–≤–∞–µ–º —Ç–µ–∫—Å—Ç –ø–∏—Å—å–º–∞ –ø–æ –ª–µ–≤–æ–º—É –∫—Ä–∞—é –¥–ª—è —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏ */
    transform: none; /* –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å—Ç–∞—Ä—ã–µ —Å—Ç–∏–ª–∏ */
    margin-bottom: 15px;
  }

  /* --- –°—Ç–∏–ª–∏ –¥–ª—è –º–∏–Ω–∏-–∏–≥—Ä –∏ —ç—Ñ—Ñ–µ–∫—Ç–æ–≤ --- */
  #game-board {
    min-height: 300px;
    display: flex;
    justify-content: center;
    align-items: center;
    perspective: 1000px;
  }
  .memory-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 10px;
  }
  .memory-card {
    width: clamp(50px, 15vw, 80px);
    height: clamp(50px, 15vw, 80px);
    position: relative;
    transform-style: preserve-3d;
    transition: transform 0.6s;
    cursor: pointer;
  }
  .memory-card.is-flipped {
    transform: rotateY(180deg);
  }
  .card-face {
    position: absolute;
    width: 100%;
    height: 100%;
    backface-visibility: hidden;
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: clamp(24px, 10vw, 40px);
    border-radius: 10px;
  }
  .card-front {
    background: #ff8080;
    color: white;
  }
  .card-back {
    background: #ffc0cb;
    color: #d14f4f;
    transform: rotateY(180deg);
  }
  .heart-catcher {
    width: 60px;
    height: 60px;
    font-size: 50px;
    position: absolute;
    cursor: pointer;
    transition: all 0.2s ease;
  }
  .typing-cursor {
    animation: pulse 0.7s infinite;
  }
  .quiz-question {
    font-size: clamp(18px, 4vw, 22px);
    margin-bottom: 20px;
    color: white;
  }
  .quiz-options {
    display: flex;
    flex-direction: column;
    gap: 10px;
  }
  .quiz-option {
    padding: 12px;
    background: #ff8080;
    color: white;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    transition: background 0.3s, opacity 0.3s;
    font-size: 16px;
  }
  .quiz-option:hover:not(:disabled) {
    background: #ff4d4d;
  }
  .quiz-option.correct { background: #4CAF50; }
  .quiz-option.incorrect {
    background: #f44336;
    opacity: 0.7;
  }
  /* --- –ù–æ–≤—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è –∏–≥—Ä --- */
  .balloon {
    font-size: 40px;
    position: absolute;
    cursor: pointer;
    transition: transform 0.2s;
    user-select: none;
  }
  .balloon:hover { transform: scale(1.2); }

  .tictactoe-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    width: clamp(210px, 80vw, 300px);
    height: clamp(210px, 80vw, 300px);
    gap: 10px;
  }
  .tictactoe-cell {
    background: #ffc0cb;
    border-radius: 10px;
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: clamp(40px, 15vw, 60px);
    cursor: pointer;
    color: #d14f4f;
    transition: background 0.3s;
  }
  .tictactoe-cell:hover:not(.filled) { background: #ffb5c1; }
  .tictactoe-cell.filled { cursor: not-allowed; }

  /* –°—Ç–∏–ª–∏ –¥–ª—è –∏–≥—Ä—ã "–®–∏—Ñ—Ä –õ—é–±–≤–∏" */
  .cipher-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 15px;
  }
  .cipher-text {
    font-size: clamp(24px, 8vw, 32px);
    color: #ffc0cb;
    letter-spacing: 5px;
    font-weight: bold;
  }
  .cipher-input {
    padding: 10px;
    border-radius: 8px;
    border: 2px solid #ff8080;
    background: rgba(255,255,255,0.2);
    color: white;
    text-align: center;
    font-size: 18px;
    width: 80%;
  }
  .nav-button {
    padding: 12px 24px;
    background: #d14f4f;
    color: white;
    text-decoration: none;
    border: none;
    border-radius: 8px;
    transition: all 0.3s ease;
    font-weight: bold;
    cursor: pointer;
  }
  .nav-button:hover {
    background: #a13f3f;
    transform: scale(1.05);
  }
  .nav-back {
    position: absolute;
    top: 10px; /* –ü–æ–¥–Ω—è–ª–∏ –∫–Ω–æ–ø–∫—É –µ—â–µ –≤—ã—à–µ */
    left: 10px;
    z-index: 3; /* –ö–Ω–æ–ø–∫–∞ –Ω–∞–∑–∞–¥ –≤—Å–µ–≥–¥–∞ —Å–≤–µ—Ä—Ö—É */
  }
  .nav-next {
    margin-top: 20px;
  }
  .game-controls {
    margin-top: 20px;
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 10px;
  }

  .video-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    gap: 15px;
    margin-top: 20px;
  }
  .video-grid video {
    width: 100%;
    height: auto;
    border-radius: 10px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.5);
    mix-blend-mode: screen; /* –ú–∞–≥–∏—è —Å–º–µ—à–∏–≤–∞–Ω–∏—è —Å —Ñ–æ–Ω–æ–º */
    filter: brightness(1.1); /* –î–µ–ª–∞–µ–º –≤–∏–¥–µ–æ —á—É—Ç—å —è—Ä—á–µ –¥–ª—è –ª—É—á—à–µ–≥–æ —ç—Ñ—Ñ–µ–∫—Ç–∞ */
  }
  .word {
    position: absolute;
    font-weight: bold;
    text-shadow: 2px 2px 6px rgba(0,0,0,0.8);
    z-index: 1;
    top: -50px; /* –ù–∞—á–∞–ª—å–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è –∑–∞ —ç–∫—Ä–∞–Ω–æ–º */
    animation: fall linear;
    white-space: nowrap;
  }
</style>
</head>
<body>

<!-- –≠—Ç–æ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –±—É–¥–µ—Ç –º–µ–Ω—è—Ç—å —Å–≤–æ—ë —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ -->
<main id="page-container"></main>

<button class="music-button" id="musicToggle">üîá</button>

<audio id="backgroundMusic" loop>
  <source src="lo.mp3" type="audio/mpeg">
  –í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —ç–ª–µ–º–µ–Ω—Ç audio.
</audio>

<script>
document.addEventListener('DOMContentLoaded', () => {

  // --- –≠–õ–ï–ú–ï–ù–¢–´ –ò –ù–ê–°–¢–†–û–ô–ö–ò ---
  const pageContainer = document.getElementById('page-container');
  const musicButton = document.getElementById('musicToggle');
  const backgroundMusic = document.getElementById('backgroundMusic');
  let isMusicPlaying = false;
  let userHasInteracted = false;

  // --- –®–ê–ë–õ–û–ù–´ –≠–ö–†–ê–ù–û–í ---
  const screens = {
    home: `
      <div class="main-content">
        <h1>–ú–æ—ë —Å–µ—Ä–¥—Ü–µ –±—å—ë—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è —Ç–µ–±—è üíñ</h1>
        <p>–≠—Ç–æ –ª–∏—à—å –º–∞–ª–µ–Ω—å–∫–∞—è —á–∞—Å—Ç—å –º–æ–∏—Ö —á—É–≤—Å—Ç–≤...</p>
        <button class="center-button" data-target="letter">–û—Ç–∫—Ä—ã—Ç—å üíå</button>
      </div>`,
    letter: `
      <div class="content-wrapper">
        <button class="nav-button nav-back" data-target="home">–ù–∞–∑–∞–¥</button>
        <h2 id="letter-title">–ú–æ–µ–π —Å–∞–º–æ–π –ª—é–±–∏–º–æ–π...</h2>
        <p class="letter-text">–õ—é–±–∏–º–∞—è, –∫–æ–≥–¥–∞ —è –¥—É–º–∞—é –æ —Ç–µ–±–µ, –º–∏—Ä —Å–ª–æ–≤–Ω–æ –∑–∞–º–µ–¥–ª—è–µ—Ç—Å—è –∏ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —Ç–∏—à–µ. –í –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É –º–æ–µ–π –ø–æ–≤—Å–µ–¥–Ω–µ–≤–Ω–æ—Å—Ç–∏ —Ç—ã –ø—Ä–∏–Ω–æ—Å–∏—à—å —Å–≤–µ—Ç, —Ç–µ–ø–ª–æ –∏ —Å–ø–æ–∫–æ–π—Å—Ç–≤–∏–µ. –Ø –ª–æ–≤–ª—é —Å–µ–±—è –Ω–∞ —Ç–æ–º, —á—Ç–æ —É–ª—ã–±–∞—é—Å—å –ø—Ä–æ—Å—Ç–æ –æ—Ç –º—ã—Å–ª–∏ –æ —Ç–≤–æ—ë–º –≥–æ–ª–æ—Å–µ –∏ —Ç–≤–æ—ë–º –≤–∑–≥–ª—è–¥–µ. –¢—ã ‚Äî –º–æ–π —Å–∞–º—ã–π –ª—é–±–∏–º—ã–π —á–µ–ª–æ–≤–µ–∫, –º–æ—è –æ–ø–æ—Ä–∞ –∏ –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ. –° —Ç–æ–±–æ–π —Ö–æ—á–µ—Ç—Å—è –¥–µ–ª–∏—Ç—å—Å—è –∫–∞–∂–¥—ã–º –¥–Ω—ë–º, –∫–∞–∂–¥—ã–º –º–∞–ª–µ–Ω—å–∫–∏–º –æ—Ç–∫—Ä—ã—Ç–∏–µ–º –∏ –∫–∞–∂–¥–æ–π –º–µ—á—Ç–æ–π.</p>
        <p class="letter-text">–Ø –ª—é–±–ª—é, –∫–∞–∫ —Ç—ã —Å–º–µ—ë—à—å—Å—è, –∫–∞–∫ –∏—Å–∫—Ä–µ–Ω–Ω–µ —Ä–∞–¥—É–µ—à—å—Å—è –ø—Ä–æ—Å—Ç—ã–º –≤–µ—â–∞–º –∏ –∫–∞–∫ —É–º–µ–µ—à—å –∑–∞–º–µ—á–∞—Ç—å –∫—Ä–∞—Å–æ—Ç—É —Ç–∞–º, –≥–¥–µ –¥—Ä—É–≥–∏–µ –ø—Ä–æ—Ö–æ–¥—è—Ç –º–∏–º–æ. –ú–Ω–µ –¥–æ—Ä–æ–≥–æ –≤—Å—ë, —á—Ç–æ —Å–≤—è–∑–∞–Ω–æ —Å —Ç–æ–±–æ–π: —Ç–≤–æ–∏ –ø—Ä–∏–≤—ã—á–∫–∏, —Ç–≤–æ–∏ –º–∞–ª–µ–Ω—å–∫–∏–µ —Å—Ç—Ä–∞–Ω–Ω–æ—Å—Ç–∏, —Ç–≤–æ–∏ –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã –∏ —Ç—ë–ø–ª—ã–µ –æ–±—ä—è—Ç–∏—è. –ö–æ–≥–¥–∞ –º—ã —Ä—è–¥–æ–º, –º–Ω–µ –∫–∞–∂–µ—Ç—Å—è, —á—Ç–æ –ª—é–±–æ–µ –∏—Å–ø—ã—Ç–∞–Ω–∏–µ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –ª–µ–≥—á–µ, –∞ –ª—é–±–∞—è —Ü–µ–ª—å ‚Äî –¥–æ—Å—Ç–∏–∂–∏–º–µ–µ. –¢—ã –¥–∞—ë—à—å –º–Ω–µ —Å–∏–ª—ã –≤–µ—Ä–∏—Ç—å –≤ –ª—É—á—à–µ–µ –∏ —Å—Ç–∞–Ω–æ–≤–∏—Ç—å—Å—è –ª—É—á—à–µ –¥–ª—è –Ω–∞—Å –¥–≤–æ–∏—Ö.</p>
        <p class="letter-text">–Ø —á–∞—Å—Ç–æ –¥—É–º–∞—é –æ –Ω–∞—à–µ–º –±—É–¥—É—â–µ–º. –Ø –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é —É—é—Ç–Ω—ã–µ –≤–µ—á–µ—Ä–∞, –¥–ª–∏–Ω–Ω—ã–µ —Ä–∞–∑–≥–æ–≤–æ—Ä—ã –∏ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏—è, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –º—ã –±—É–¥–µ–º –æ—Ç–∫—Ä—ã–≤–∞—Ç—å –Ω–æ–≤—ã–µ –º–µ—Å—Ç–∞ –∏ –Ω–æ–≤—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã –¥—Ä—É–≥ –¥—Ä—É–≥–∞. –•–æ—á—É –±–µ—Ä–µ—á—å —Ç–µ–±—è, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –∏ –≤—Å–µ–≥–¥–∞ –±—ã—Ç—å —Ç–µ–º, –Ω–∞ –∫–æ–≥–æ –º–æ–∂–Ω–æ –ø–æ–ª–æ–∂–∏—Ç—å—Å—è. –Ø –±–ª–∞–≥–æ–¥–∞—Ä–µ–Ω —Å—É–¥—å–±–µ –∑–∞ –≤—Å—Ç—Ä–µ—á—É —Å —Ç–æ–±–æ–π –∏ –∑–∞ –≤—Å—ë, —á–µ–º—É —Ç—ã –º–µ–Ω—è —É—á–∏—à—å ‚Äî –ª—é–±–∏—Ç—å, —Å–ª—ã—à–∞—Ç—å –∏ –±—ã—Ç—å –Ω–∞—Å—Ç–æ—è—â–∏–º. –ü—É—Å—Ç—å —ç—Ç–æ –ø–∏—Å—å–º–æ —Å—Ç–∞–Ω–µ—Ç –º–∞–ª–µ–Ω—å–∫–∏–º –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ–º: –º–æ—ë —Å–µ—Ä–¥—Ü–µ –≤—ã–±—Ä–∞–ª–æ —Ç–µ–±—è –æ–¥–Ω–∞–∂–¥—ã ‚Äî –∏ –≤—ã–±–∏—Ä–∞–µ—Ç –∫–∞–∂–¥—ã–π –¥–µ–Ω—å —Å–Ω–æ–≤–∞.</p>
        <p class="letter-text">–°–ø–∞—Å–∏–±–æ —Ç–µ–±–µ –∑–∞ —Ç–≤–æ—é –¥–æ–±—Ä–æ—Ç—É, –∑–∞ —Ç–≤–æ—é –Ω–µ–∂–Ω–æ—Å—Ç—å –∏ –∑–∞ —Ç–æ, —á—Ç–æ —Ç—ã –µ—Å—Ç—å. –Ø –ª—é–±–ª—é —Ç–µ–±—è —Ç–∞–∫, –∫–∞–∫ —Ä–∞–Ω—å—à–µ –Ω–µ —É–º–µ–ª ‚Äî –≥–ª—É–±–æ–∫–æ, —Å–ø–æ–∫–æ–π–Ω–æ –∏ —É–≤–µ—Ä–µ–Ω–Ω–æ. –ò –ø—É—Å—Ç—å –≤–ø–µ—Ä–µ–¥–∏ —É –Ω–∞—Å –µ—â—ë —Ç—ã—Å—è—á–∏ –∏—Å—Ç–æ—Ä–∏–π, –±–æ–ª—å—à–∏—Ö –∏ –º–∞–ª–µ–Ω—å–∫–∏—Ö, —è —Ö–æ—á—É –ø—Ä–æ–∂–∏—Ç—å –∏—Ö –≤—Å–µ –≤–º–µ—Å—Ç–µ —Å —Ç–æ–±–æ–π. –û–±–Ω–∏–º–∞—é —Ç–µ–±—è –º—ã—Å–ª–µ–Ω–Ω–æ –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å –∏ —à–µ–ø—á—É: —Ç—ã ‚Äî –º–æ—ë —á—É–¥–æ, –º–æ—è —Ä–∞–¥–æ—Å—Ç—å –∏ –º–æ–π –¥–æ–º.</p>
        <button class="nav-button nav-next" data-target="videos">–î–∞–ª—å—à–µ</button>
      </div>`,
    videos: `
      <div class="content-wrapper">
        <button class="nav-button nav-back" data-target="letter">–ù–∞–∑–∞–¥</button>
        <h2>–ù–∞—à–∏ –ª—É—á—à–∏–µ –º–æ–º–µ–Ω—Ç—ã</h2>
        <div class="video-grid">
          ${[1, 2, 3, 5, 6, 7, 8].map(num => `<video src="${num}.mp4" autoplay loop muted playsinline></video>`).join('')}
        </div>
        <button class="nav-button nav-next" data-target="games">–ü–æ–∏–≥—Ä–∞–µ–º?</button>
      </div>`,
    games: `
      <div class="content-wrapper">
        <button class="nav-button nav-back" data-target="videos">–ù–∞–∑–∞–¥</button>
        <h2 id="game-title">–í—Ä–µ–º—è –¥–ª—è –∏–≥—Ä!</h2>
        <div id="game-board"></div>
        <p id="game-message" style="min-height: 24px; margin-top: 15px;"></p>
        <div class="game-controls"><button class="nav-button" data-action="new-game">–î—Ä—É–≥–∞—è –∏–≥—Ä–∞</button><button class="nav-button" data-action="main-menu">–ù–∞ –≥–ª–∞–≤–Ω—É—é</button></div>
      </div>`
  };

  // --- –§–£–ù–ö–¶–ò–Ø –°–ú–ï–ù–´ –≠–ö–†–ê–ù–ê ---
  async function showScreen(screenName) {
    // –£–ø—Ä–∞–≤–ª—è–µ–º –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ–º –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —ç–∫—Ä–∞–Ω–æ–≤
    if (screenName === 'home') {
      document.body.style.alignItems = 'center';
    } else if (screenName === 'games') {
      document.body.style.alignItems = 'flex-start';
      // –ó–∞–¥–µ—Ä–∂–∫–∞ –Ω—É–∂–Ω–∞, —á—Ç–æ–±—ã DOM —É—Å–ø–µ–ª –æ–±–Ω–æ–≤–∏—Ç—å—Å—è
      setTimeout(gameManager.startRandomGame, 100);
    } else if (screenName === 'letter') {
      document.body.style.alignItems = 'flex-start';
    } else {
      document.body.style.alignItems = 'flex-start';
    }

    pageContainer.style.opacity = 0;
    await new Promise(resolve => setTimeout(resolve, 500)); // –ñ–¥–µ–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∞–Ω–∏–º–∞—Ü–∏–∏
    pageContainer.innerHTML = screens[screenName] || screens['home'];
    pageContainer.style.opacity = 1;

    // –ó–∞–ø—É—Å–∫–∞–µ–º —ç—Ñ—Ñ–µ–∫—Ç—ã –ø–æ—Å–ª–µ –æ—Ç—Ä–∏—Å–æ–≤–∫–∏
    if (screenName === 'letter') {
      const paragraphs = pageContainer.querySelectorAll('.letter-text');
      const texts = Array.from(paragraphs).map(p => p.textContent);
      paragraphs.forEach(p => p.textContent = ''); // –û—á–∏—â–∞–µ–º
      
      // –ó–∞–ø—É—Å–∫–∞–µ–º –ø–µ—á–∞—Ç—å –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è –≤—Å–µ—Ö –∞–±–∑–∞—Ü–µ–≤
      for (let i = 0; i < paragraphs.length; i++) {
          await typewriter(paragraphs[i], texts[i]);
      }
    }
  }

  // --- –£–ü–†–ê–í–õ–ï–ù–ò–ï –ù–ê–í–ò–ì–ê–¶–ò–ï–ô ---
  pageContainer.addEventListener('click', (event) => {
    const targetButton = event.target.closest('[data-target]');
    const actionButton = event.target.closest('[data-action]');
    if (actionButton) {
        const action = actionButton.dataset.action;
        if (action === 'new-game') gameManager.startRandomGame();
        if (action === 'play-again') gameManager.restartCurrentGame();
        if (action === 'main-menu') showScreen('home');
    } else if (targetButton) {
      const screenName = targetButton.dataset.target;
      showScreen(screenName);
    }
  });

  // --- –£–ü–†–ê–í–õ–ï–ù–ò–ï –ú–£–ó–´–ö–û–ô ---
  function toggleMusic() {
    if (isMusicPlaying) {
      backgroundMusic.pause();
      musicButton.textContent = "üîá";
    } else {
      backgroundMusic.play().catch(e => console.log("–ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ –º—É–∑—ã–∫–∏ –Ω–µ —É–¥–∞–ª—Å—è."));
      musicButton.textContent = "üé∂";
    }
    isMusicPlaying = !isMusicPlaying;
  }
  musicButton.addEventListener('click', toggleMusic);
  document.body.addEventListener('click', () => {
    if (!userHasInteracted) {
      userHasInteracted = true;
      if (!isMusicPlaying) toggleMusic();
    }
  }, { once: true });

  // --- –≠–§–§–ï–ö–¢ –ü–ï–ß–ê–¢–ù–û–ô –ú–ê–®–ò–ù–ö–ò ---
  function typewriter(element, text, speed = 50) {
    return new Promise(resolve => {
      let i = 0;
      const cursor = document.createElement('span');
      cursor.className = 'typing-cursor';
      cursor.textContent = '|';
      element.appendChild(cursor);

      function type() {
        if (i < text.length) {
          cursor.before(text.charAt(i));
          i++;
          setTimeout(type, speed);
        } else {
          cursor.remove();
          resolve(); // –°–æ–æ–±—â–∞–µ–º, —á—Ç–æ –ø–µ—á–∞—Ç—å –∑–∞–∫–æ–Ω—á–µ–Ω–∞
        }
      }
      type();
    });
  }

  // --- –õ–û–ì–ò–ö–ê –ú–ò–ù–ò-–ò–ì–† ---
  const gameManager = {
  currentGameIndex: -1,
  _cleanups: [],

  // —Å–ª—É–∂–µ–±–Ω—ã–µ: –æ—á–∏—â–∞–µ–º –≤—Å—ë, —á—Ç–æ –º–æ–≥–ª–æ –æ—Å—Ç–∞—Ç—å—Å—è –æ—Ç –ø—Ä–µ–¥—ã–¥—É—â–µ–π –∏–≥—Ä—ã
  _resetBoard(title) {
    const board = document.getElementById('game-board');
    const msg   = document.getElementById('game-message');
    document.getElementById('game-title').textContent = title || '';
    msg.textContent = '';
    board.innerHTML = '';
    board.style.position = 'relative';
    board.style.overflow = 'hidden';
    board.style.userSelect = 'none';
    // –≤—ã–ø–æ–ª–Ω–∏—Ç—å –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –æ—á–∏—Å—Ç–∫–∏ (—Å–Ω—è—Ç–∏–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤/—Å–ª—É—à–∞—Ç–µ–ª–µ–π/raf)
    this._cleanups.forEach(fn => { try { fn(); } catch(_){} });
    this._cleanups = [];
  },

  _onCleanup(fn) { this._cleanups.push(fn); },

  games: [
    /* ===================== 1) –õ–û–í–ò –ü–û–î–ê–†–ö–ò üéÅ ===================== */
    {
      name: "–õ–æ–≤–∏ –ø–æ–¥–∞—Ä–∫–∏",
      init: function () {
        gameManager._resetBoard(this.name);
        const board = document.getElementById('game-board');
        const msg   = document.getElementById('game-message');

        // –∫–æ—Ä–∑–∏–Ω–∫–∞ (–≤–Ω–∏–∑—É) –∏ —Å—á—ë—Ç
        const basket = document.createElement('div');
        basket.textContent = 'üß∫';
        Object.assign(basket.style, {
          position:'absolute', bottom:'8px', left:'50%', transform:'translateX(-50%)',
          fontSize:'32px', lineHeight:'1'
        });
        board.appendChild(basket);

        let score = 0;
        const target = 7;
        msg.textContent = `–ü–æ–π–º–∞–π ${target} –ø–æ–¥–∞—Ä–∫–æ–≤! 0/${target}`;

        // —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ—Ä–∑–∏–Ω–∫–æ–π ‚Äî –º—ã—à—å –∏ —Ç–∞—á
        const moveBasket = (clientX) => {
          const r = board.getBoundingClientRect();
          const x = Math.min(Math.max(clientX - r.left, 0), r.width);
          basket.style.left = `${x}px`;
          basket.style.transform = 'translateX(-50%)';
        };
        const onMouseMove = (e)=> moveBasket(e.clientX);
        const onTouchMove = (e)=> { if (e.touches[0]) moveBasket(e.touches[0].clientX); };

        window.addEventListener('mousemove', onMouseMove);
        window.addEventListener('touchmove', onTouchMove, {passive:true});
        gameManager._onCleanup(()=> {
          window.removeEventListener('mousemove', onMouseMove);
          window.removeEventListener('touchmove', onTouchMove);
        });

        // –ø–∞–¥–µ–Ω–∏–µ –ø–æ–¥–∞—Ä–∫–æ–≤
        let running = true;
        const rafIds = new Set();
        const spawnGift = () => {
          if (!running) return;
          const gift = document.createElement('div');
          gift.textContent = Math.random()<0.85 ? 'üéÅ' : 'üíñ';
          gift.style.position='absolute';
          gift.style.top='-40px';
          const br = board.getBoundingClientRect();
          const x = Math.random() * (br.width - 32);
          gift.style.left = `${x}px`;
          gift.style.fontSize = '28px';
          board.appendChild(gift);

          let y = -40;
          const speed = 1.2 + Math.random()*2.2;
          const fall = () => {
            if (!running) return;
            y += speed;
            gift.style.top = `${y}px`;

            const gr = gift.getBoundingClientRect();
            const brd = board.getBoundingClientRect();
            const bas = basket.getBoundingClientRect();

            // –∫–∞—Å–∞–Ω–∏–µ –∫–æ—Ä–∑–∏–Ω–∫–∏
            const intersects = !(gr.right < bas.left || gr.left > bas.right || gr.bottom < bas.top || gr.top > bas.bottom);
            if (intersects) {
              score++;
              msg.textContent = `–ü–æ–π–º–∞–π ${target} –ø–æ–¥–∞—Ä–∫–æ–≤! ${score}/${target}`;
              gift.remove();
              if (score >= target) {
                running = false;
                msg.textContent = `–£–º–Ω–∏—á–∫–∞! –ü–æ–π–º–∞–Ω–æ ${score}/${target} ‚ù§Ô∏è`;
              }
              return;
            }
            // —É–ª–µ—Ç–µ–ª –Ω–∏–∂–µ
            if (y > brd.height + 40) {
              gift.remove();
              return;
            }
            const id = requestAnimationFrame(fall);
            rafIds.add(id);
          };
          const id = requestAnimationFrame(fall);
          rafIds.add(id);
        };

        const spawner = setInterval(spawnGift, 600);
        gameManager._onCleanup(()=> { clearInterval(spawner); running=false; rafIds.forEach(cancelAnimationFrame); });
      }
    },

    /* ===================== 2) –ü–û–ô–ú–ê–ô –ö–û–¢–ò–ö–ê üê± ===================== */
    {
      name: "–ü–æ–π–º–∞–π –∫–æ—Ç–∏–∫–∞",
      init: function () {
        gameManager._resetBoard(this.name);
        const board = document.getElementById('game-board');
        const msg   = document.getElementById('game-message');
        msg.textContent = '–ü–æ–π–º–∞–π –∫–æ—Ç–∏–∫–∞ 5 —Ä–∞–∑!';

        const cat = document.createElement('div');
        cat.textContent = 'üê±';
        Object.assign(cat.style, {
          position:'absolute', fontSize:'40px', left:'50px', top:'50px', cursor:'pointer'
        });
        board.appendChild(cat);

        let caught = 0;
        let vx = 2 + Math.random()*2;
        let vy = 1.5 + Math.random()*2;
        const rafIds = new Set();
        const move = () => {
          const br = board.getBoundingClientRect();
          const x = (parseFloat(cat.style.left) || 0) + vx;
          const y = (parseFloat(cat.style.top)  || 0) + vy;
          if (x < 0 || x > br.width - 40) vx *= -1;
          if (y < 0 || y > br.height - 40) vy *= -1;
          cat.style.left = `${Math.min(Math.max(x,0), br.width - 40)}px`;
          cat.style.top  = `${Math.min(Math.max(y,0), br.height - 40)}px`;
          const id = requestAnimationFrame(move);
          rafIds.add(id);
        };
        const id = requestAnimationFrame(move);
        rafIds.add(id);

        const onClick = () => {
          caught++;
          msg.textContent = `–ü–æ–π–º–∞–Ω–æ: ${caught}/5`;
          // —Ç–µ–ª–µ–ø–æ—Ä—Ç –ø–æ—Å–ª–µ –∫–ª–∏–∫–∞
          const br = board.getBoundingClientRect();
          cat.style.left = `${Math.random()*(br.width-40)}px`;
          cat.style.top  = `${Math.random()*(br.height-40)}px`;
          if (caught >= 5) {
            msg.textContent = '–¢—ã —Å—É–ø–µ—Ä! –ö–æ—Ç–∏–∫ –ø–æ–π–º–∞–Ω! ü•≥';
            cat.style.pointerEvents = 'none';
          }
        };
        cat.addEventListener('click', onClick);
        gameManager._onCleanup(()=> { rafIds.forEach(cancelAnimationFrame); cat.removeEventListener('click', onClick); });
      }
    },

    /* ===================== 3) –ö–õ–ò–ö-–¢–ê–ô–ú–ï–† ‚è±Ô∏è ===================== */
    {
      name: "–ö–ª–∏–∫-—Ç–∞–π–º–µ—Ä",
      init: function () {
        gameManager._resetBoard(this.name);
        const board = document.getElementById('game-board');
        const msg   = document.getElementById('game-message');

        let timeLeft = 5.0;
        let clicks = 0;

        const btn = document.createElement('button');
        btn.textContent = '–ñ–º–∏ –∫–∞–∫ –º–æ–∂–Ω–æ –±–æ–ª—å—à–µ!';
        Object.assign(btn.style, {
          fontSize:'18px', padding:'12px 16px', borderRadius:'10px', cursor:'pointer'
        });
        board.appendChild(btn);

        msg.textContent = `–í—Ä–µ–º—è: ${timeLeft.toFixed(1)} —Å–µ–∫ | –ö–ª–∏–∫–∏: ${clicks}`;

        const timer = setInterval(() => {
          timeLeft = Math.max(0, timeLeft - 0.1);
          msg.textContent = `–í—Ä–µ–º—è: ${timeLeft.toFixed(1)} —Å–µ–∫ | –ö–ª–∏–∫–∏: ${clicks}`;
          if (timeLeft <= 0) {
            clearInterval(timer);
            btn.disabled = true;
            msg.textContent = `–ì–æ—Ç–æ–≤–æ! –ö–ª–∏–∫–∏: ${clicks} ${clicks>=30 ? 'üî• –ß–µ–º–ø–∏–æ–Ω!' : 'üëè –û—Ç–ª–∏—á–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç!'}`;
          }
        }, 100);

        const onClick = () => { clicks++; };
        btn.addEventListener('click', onClick);
        gameManager._onCleanup(()=> { clearInterval(timer); btn.removeEventListener('click', onClick); });
      }
    },

    /* ===================== 4) –ü–£–ó–´–†–¨–ö–ò ü´ß ===================== */
    {
      name: "–ü—É–∑—ã—Ä—å–∫–∏",
      init: function () {
        gameManager._resetBoard(this.name);
        const board = document.getElementById('game-board');
        const msg   = document.getElementById('game-message');

        let popped = 0;
        const target = 12;
        msg.textContent = `–õ–æ–ø–Ω–∏ ${target} –ø—É–∑—ã—Ä—å–∫–æ–≤! 0/${target}`;

        const rafIds = new Set();
        let running = true;

        const spawn = () => {
          if (!running) return;
          const b = document.createElement('div');
          b.textContent = 'ü´ß';
          Object.assign(b.style, {
            position:'absolute', fontSize:'28px', bottom:'-40px',
            left: Math.random()* (board.clientWidth - 28) + 'px', cursor:'pointer'
          });
          board.appendChild(b);

          const onClick = () => {
            if (!running) return;
            popped++;
            msg.textContent = `–õ–æ–ø–Ω–∏ ${target} –ø—É–∑—ã—Ä—å–∫–æ–≤! ${popped}/${target}`;
            b.removeEventListener('click', onClick);
            b.remove();
            if (popped >= target) {
              running = false;
              msg.textContent = `–£—Ä–∞! ${popped}/${target} üíñ`;
            }
          };
          b.addEventListener('click', onClick);

          let y = -40;
          const speed = 1 + Math.random()*1.6;
          const floatUp = () => {
            if (!running) return;
            y += speed;
            b.style.bottom = `${y}px`;
            if (parseFloat(b.style.bottom) > board.clientHeight + 50) {
              b.removeEventListener('click', onClick);
              b.remove();
              return;
            }
            const id = requestAnimationFrame(floatUp);
            rafIds.add(id);
          };
          const id = requestAnimationFrame(floatUp);
          rafIds.add(id);
        };

        const spawner = setInterval(spawn, 350);
        gameManager._onCleanup(()=> { running=false; clearInterval(spawner); rafIds.forEach(cancelAnimationFrame); });
      }
    },

    /* ===================== 5) –ö–ê–ú–ï–ù–¨-–ù–û–ñ–ù–ò–¶–´-–ë–£–ú–ê–ì–ê ‚úä‚úã‚úåÔ∏è ===================== */
    {
      name: "–ö–∞–º–µ–Ω—å-–Ω–æ–∂–Ω–∏—Ü—ã-–±—É–º–∞–≥–∞",
      init: function () {
        gameManager._resetBoard(this.name);
        const board = document.getElementById('game-board');
        const msg   = document.getElementById('game-message');

        const options = [
          {name:'–ö–∞–º–µ–Ω—å',  emoji:'‚úä'},
          {name:'–ù–æ–∂–Ω–∏—Ü—ã', emoji:'‚úåÔ∏è'},
          {name:'–ë—É–º–∞–≥–∞',  emoji:'‚úã'}
        ];
        const wrap = document.createElement('div');
        wrap.style.display = 'flex';
        wrap.style.gap = '12px';
        wrap.style.flexWrap = 'wrap';
        wrap.style.justifyContent = 'center';

        options.forEach((opt, idx)=>{
          const btn = document.createElement('button');
          btn.textContent = `${opt.emoji} ${opt.name}`;
          Object.assign(btn.style, {fontSize:'18px', padding:'10px 14px', borderRadius:'10px', cursor:'pointer'});
          btn.addEventListener('click', ()=>{
            const cpu = Math.floor(Math.random()*3);
            const you = idx;
            const res = (you - cpu + 3) % 3; // 0 –Ω–∏—á—å—è, 1 –ø–æ–±–µ–¥–∞, 2 –ø–æ—Ä–∞–∂–µ–Ω–∏–µ
            const text = res===0 ? '–ù–∏—á—å—è! ü§ù' : res===1 ? '–¢—ã –ø–æ–±–µ–¥–∏–ª–∞! üèÜ' : '–ö–æ–º–ø—å—é—Ç–µ—Ä –ø–æ–±–µ–¥–∏–ª! üòâ';
            msg.textContent = `–¢—ã: ${options[you].emoji} ‚Äî –ë–æ—Ç: ${options[cpu].emoji}. ${text}`;
          });
          wrap.appendChild(btn);
        });

        board.appendChild(wrap);
        msg.textContent = '–í—ã–±–µ—Ä–∏ —Å–≤–æ–π –∑–Ω–∞–∫!';
      }
    },

    /* ===================== 6) –°–û–ë–ï–†–ò –°–õ–û–í–û "LOVE" ‚ù§Ô∏è ===================== */
    {
      name: '–°–æ–±–µ—Ä–∏ —Å–ª–æ–≤–æ "LOVE"',
      init: function () {
        gameManager._resetBoard(this.name);
        const board = document.getElementById('game-board');
        const msg   = document.getElementById('game-message');

        const letters = ['L','O','V','E'];
        const shuffled = letters.slice().sort(()=>Math.random()-0.5);

        const targetBox = document.createElement('div');
        targetBox.id = 'love-target';
        Object.assign(targetBox.style, {
          display:'flex', gap:'8px', justifyContent:'center', marginBottom:'10px',
          fontSize:'28px', fontWeight:'800'
        });
        board.appendChild(targetBox);

        const bank = document.createElement('div');
        Object.assign(bank.style, {display:'flex', gap:'10px', justifyContent:'center', flexWrap:'wrap'});
        board.appendChild(bank);

        const slots = [];
        for (let i=0;i<4;i++){
          const slot = document.createElement('div');
          Object.assign(slot.style, {
            width:'48px', height:'48px', border:'2px dashed rgba(255,255,255,.35)',
            borderRadius:'10px', display:'flex', alignItems:'center', justifyContent:'center'
          });
          targetBox.appendChild(slot);
          slots.push(slot);
        }

        shuffled.forEach(ch=>{
          const b = document.createElement('button');
          b.textContent = ch;
          Object.assign(b.style, {fontSize:'22px', padding:'10px 14px', borderRadius:'10px', cursor:'pointer'});
          b.addEventListener('click', ()=>{
            const empty = slots.find(s => !s.textContent);
            if (empty) {
              empty.textContent = ch;
              empty.style.borderColor = 'transparent';
              b.remove();
              const word = slots.map(s=>s.textContent||'').join('');
              if (word === 'LOVE') msg.textContent = '–ò–¥–µ–∞–ª—å–Ω–æ! LOVE —Å–æ–±—Ä–∞–Ω–æ! üíñ';
            }
          });
          bank.appendChild(b);
        });

        msg.textContent = '–ù–∞–∂–∏–º–∞–π –±—É–∫–≤—ã, —á—Ç–æ–±—ã –∑–∞–ø–æ–ª–Ω–∏—Ç—å —Å–ª–æ—Ç—ã —Å–ª–µ–≤–∞ –Ω–∞–ø—Ä–∞–≤–æ.';
      }
    },

    /* ===================== 7) –£–ë–ï–ì–ê–Æ–©–ê–Ø –ö–ù–û–ü–ö–ê üü¶ ===================== */
    {
      name: "–ü–æ–π–º–∞–π –∫–Ω–æ–ø–∫—É",
      init: function () {
        gameManager._resetBoard(this.name);
        const board = document.getElementById('game-board');
        const msg   = document.getElementById('game-message');

        const btn = document.createElement('button');
        btn.textContent = '–ü–æ–π–º–∞–π –º–µ–Ω—è!';
        Object.assign(btn.style, {
          position:'absolute', left:'50%', top:'50%', transform:'translate(-50%,-50%)',
          fontSize:'18px', padding:'10px 16px', borderRadius:'10px', cursor:'pointer'
        });
        board.appendChild(btn);

        let wins = 0;
        msg.textContent = '–ü–æ–¥–≤–µ–¥–∏ –∫—É—Ä—Å–æ—Ä –∏ –∫–ª–∏–∫–Ω–∏. –£–¥–∞—á–∏!';

        const moveAway = (x, y) => {
          const br = board.getBoundingClientRect();
          const bw = btn.offsetWidth, bh = btn.offsetHeight;
          // –Ω–æ–≤–æ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ ‚Äî —Å–ª—É—á–∞–π–Ω–æ, –Ω–æ –≤–Ω—É—Ç—Ä–∏ –±–æ—Ä–¥–∞
          const nx = Math.min(Math.max(Math.random()*(br.width - bw), 0), br.width - bw);
          const ny = Math.min(Math.max(Math.random()*(br.height - bh), 0), br.height - bh);
          btn.style.left = nx + 'px';
          btn.style.top  = ny + 'px';
          btn.style.transform = 'translate(0,0)';
        };

        const onMouseEnter = ()=> moveAway();
        const onTouchStart = ()=> moveAway();

        btn.addEventListener('mouseenter', onMouseEnter);
        btn.addEventListener('touchstart', onTouchStart, {passive:true});

        const onClick = ()=>{
          wins++;
          msg.textContent = wins>=3 ? '–ü–æ–π–º–∞–Ω–∞! –¢—ã –Ω–µ–ø–æ–±–µ–¥–∏–º–∞! üéâ' : `–ï—Å—Ç—å! –ï—â—ë —Ä–∞–∑–æ–∫: ${wins}/3`;
          if (wins>=3) {
            btn.disabled = true;
            btn.style.opacity = '0.7';
          } else {
            moveAway();
          }
        };
        btn.addEventListener('click', onClick);

        gameManager._onCleanup(()=> {
          btn.removeEventListener('mouseenter', onMouseEnter);
          btn.removeEventListener('touchstart', onTouchStart);
          btn.removeEventListener('click', onClick);
        });
      }
    }
  ],

  startRandomGame: function () {
    let newIndex;
    do { newIndex = Math.floor(Math.random() * this.games.length); }
    while (this.games.length > 1 && newIndex === this.currentGameIndex);
    this.currentGameIndex = newIndex;
    this.games[this.currentGameIndex].init();
  },

  restartCurrentGame: function () {
    if (this.currentGameIndex !== -1) this.games[this.currentGameIndex].init();
  }
};

  // --- –ê–ù–ò–ú–ê–¶–ò–Ø –ü–ê–î–ê–Æ–©–ò–• –°–õ–û–í (–û–ü–¢–ò–ú–ò–ó–ò–†–û–í–ê–ù–ê) ---
  function spawnWord() {
    const word = document.createElement("div");
    word.className = "word";
    const messages = ["–Ø –ª—é–±–ª—é —Ç–µ–±—è", "‚ù§Ô∏è"];
    word.textContent = messages[Math.floor(Math.random() * messages.length)];
    const colors = ['#ffdddd', '#ffb6c1', '#ffc0cb', '#ffe4e1'];
    word.style.color = colors[Math.floor(Math.random() * colors.length)];
    word.style.left = Math.random() * window.innerWidth + "px";
    word.style.fontSize = (18 + Math.random() * 8) + "px";
    word.style.animationDuration = (6 + Math.random() * 6) + 's'; // –ß—É—Ç—å –º–µ–¥–ª–µ–Ω–Ω–µ–µ –¥–ª—è –ª—É—á—à–µ–≥–æ —ç—Ñ—Ñ–µ–∫—Ç–∞
    word.style.opacity = 0.5 + Math.random() * 0.5;
    document.body.appendChild(word);
    word.addEventListener('animationend', () => word.remove());
  }
  const spawnRate = window.innerWidth < 768 ? 500 : 150;
  setInterval(spawnWord, spawnRate);

  // --- –ó–ê–ü–£–°–ö ---
  showScreen('home');
});
</script>

</body>
</html>
